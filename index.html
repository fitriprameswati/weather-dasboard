<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GitHub-Inspired Modern Weather Dashboard</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
<style>
  /* Reset & base */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif,
      "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    background: #f6f8fa;
    color: #24292e;
    height: 100vh;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    overflow-x: hidden;
  }

  a {
    color: #0366d6;
    text-decoration: none;
  }
  a:hover, a:focus {
    text-decoration: underline;
    outline-offset: 2px;
  }

  h1, h2, h3, h4 {
    margin: 0;
    font-weight: 600;
  }
  h1 {
    font-size: 1.75rem;
  }
  h2 {
    font-size: 1.25rem;
    margin-bottom: 8px;
  }
  h3 {
    font-size: 1rem;
  }

  /* Container max width and padding */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 16px 32px 16px;
    flex: 1 0 auto;
  }

  /* Header */
  header {
    background: linear-gradient(90deg, #24292e, #0366d6);
    color: #fff;
    padding: 16px 32px;
    display: flex;
    align-items: center;
    gap: 16px;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  header h1 {
    flex-shrink: 0;
    font-weight: 700;
    font-size: 1.5rem;
    letter-spacing: 1px;
  }
  .location-selector {
    position: relative;
    flex-grow: 1;
  }
  .location-select {
    width: 100%;
    border: none;
    border-radius: 6px;
    padding: 8px 36px 8px 12px;
    font-size: 1rem;
    font-family: inherit;
    background: #ffffff66;
    color: #24292e;
    appearance: none;
    cursor: pointer;
  }
  .location-select:focus {
    outline: 3px solid #79b8ff;
    background: #ffffffcc;
  }
  .location-selector .material-icons {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
  }
  .search-container {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
  }
  .search-input {
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid #cdd9e5;
    font-size: 1rem;
    width: 180px;
    font-family: inherit;
  }
  .search-input:focus {
    outline: 3px solid #79b8ff;
    border-color: #79b8ff;
  }
  .icon-button {
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 24px;
    padding: 4px;
    border-radius: 6px;
    transition: background 0.2s ease;
  }
  .icon-button:hover,
  .icon-button:focus {
    background: #184e8a;
    outline: none;
  }

  /* Main area */
  main {
    flex: 1 1 auto;
  }

  /* Dynamic backgrounds by condition */
  body[data-condition="sunny"] {
    background: linear-gradient(135deg, #fff8e1, #fef3c7);
  }
  body[data-condition="cloudy"] {
    background: linear-gradient(135deg, #d6d8db, #f0f2f4);
  }
  body[data-condition="rainy"] {
    background: linear-gradient(135deg, #5a7184, #9ab3c8);
  }
  body[data-condition="snowy"] {
    background: linear-gradient(135deg, #e0f5ff, #f0fbff);
  }
  body[data-condition="stormy"] {
    background: linear-gradient(135deg, #3a4150, #6b798b);
  }

  /* Glass morphism card */
  .card {
    background: rgba(255 255 255 / 0.6);
    backdrop-filter: blur(12px);
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    padding: 20px;
    margin-bottom: 24px;
    color: #24292e;
    transition: background 0.3s ease;
  }
  body[data-condition="stormy"] .card {
    background: rgba(30 34 45 / 0.7);
    color: #eee;
  }
  body[data-condition="rainy"] .card {
    background: rgba(220 230 250 / 0.7);
  }
  body[data-condition="snowy"] .card {
    background: rgba(245 255 255 / 0.8);
  }
  body[data-condition="cloudy"] .card {
    background: rgba(240 245 250 / 0.75);
  }

  /* Current weather */
  .current-weather {
    display: flex;
    align-items: center;
    gap: 24px;
    justify-content: center;
    padding: 24px 12px;
  }
  .current-temp {
    font-size: 6rem;
    font-weight: 700;
    line-height: 1;
    min-width: 130px;
    text-align: center;
  }
  .current-condition {
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-size: 1.2rem;
    font-weight: 600;
    text-align: center;
  }
  .weather-icon {
    width: 120px;
    height: 120px;
    animation: floatIcon 4s ease-in-out infinite;
  }
  @keyframes floatIcon {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-12px); }
  }

  /* Scrollable hourly forecast */
  .hourly-forecast {
    overflow-x: auto;
    margin-bottom: 32px;
  }
  .hourly-list {
    display: flex;
    gap: 12px;
  }
  .hourly-card {
    flex: 0 0 72px;
    background: rgba(255 255 255 / 0.75);
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.06);
    padding: 12px 8px;
    text-align: center;
    font-size: 0.85rem;
    cursor: default;
    position: relative;
    user-select: none;
  }
  .hourly-card:hover {
    background: rgba(255 255 255 / 0.9);
    box-shadow: 0 6px 14px rgba(0,0,0,0.12);
  }
  .hourly-time {
    font-weight: 600;
    margin-bottom: 6px;
    color: #0366d6;
  }
  .hourly-temp {
    font-weight: 700;
    margin-top: 4px;
  }
  .hourly-icon {
    width: 36px;
    height: 36px;
    margin: 0 auto;
    display: block;
  }

  /* 7-day forecast */
  .daily-forecast {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 20px;
    margin-bottom: 32px;
  }
  .daily-card {
    background: rgba(255 255 255 / 0.85);
    border-radius: 14px;
    box-shadow: 0 6px 12px rgba(0,0,0,0.1);
    padding: 16px 12px;
    cursor: default;
    user-select: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    transition: background 0.3s ease;
  }
  .daily-card:hover {
    background: rgba(255 255 255 / 0.95);
    box-shadow: 0 12px 24px rgba(0,0,0,0.15);
  }
  .daily-day {
    font-weight: 700;
    color: #0366d6;
  }
  .daily-icon {
    width: 48px;
    height: 48px;
  }
  .daily-temp {
    font-weight: 600;
    color: #444;
    display: flex;
    gap: 8px;
  }
  .temp-high {
    color: #d73a49; /* red */
  }
  .temp-low {
    color: #0366d6; /* blue */
  }

  /* Air quality & UV index cards */
  .metrics-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 24px;
    margin-bottom: 32px;
  }
  .metric-card {
    background: rgba(255 255 255 / 0.9);
    border-radius: 14px;
    box-shadow: 0 6px 12px rgba(0,0,0,0.1);
    padding: 20px;
    text-align: center;
    user-select: none;
    cursor: default;
    position: relative;
  }
  .metric-title {
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 12px;
    color: #24292e;
  }
  .circular-progress {
    position: relative;
    width: 120px;
    height: 120px;
    margin: 0 auto 12px auto;
  }
  .circular-progress svg {
    transform: rotate(-90deg);
    width: 120px;
    height: 120px;
  }
  .circular-progress circle {
    fill: none;
    stroke-width: 12;
    stroke-linecap: round;
  }
  .progress-bg {
    stroke: #e1e4e8;
  }
  .progress-fg {
    stroke: #0366d6;
    transition: stroke-dashoffset 0.4s ease;
  }
  .progress-value {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: 700;
    font-size: 1.8rem;
    color: #24292e;
  }

  /* Weather map section */
  .map-section {
    margin-bottom: 32px;
  }
  .map-tabs {
    display: flex;
    gap: 12px;
    margin-bottom: 12px;
  }
  .map-tab-button {
    flex: 1;
    background: #fff;
    border-radius: 8px;
    border: 1px solid #d1d5da;
    padding: 8px 0;
    color: #24292e;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  .map-tab-button.active,
  .map-tab-button:hover {
    background: #0366d6;
    color: white;
    border-color: #0366d6;
  }
  .map-placeholder {
    height: 250px;
    border-radius: 14px;
    background: url('https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/947ca68b-f0a2-4209-8731-5b44f847f1cd.png') center/cover no-repeat;
    box-shadow: 0 6px 14px rgba(0,0,0,0.1);
  }

  /* Bottom metrics and insights */
  .bottom-metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 24px;
    margin-bottom: 48px;
  }
  .metric-item {
    background: rgba(255 255 255 / 0.85);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.07);
    padding: 16px 12px;
    text-align: center;
  }
  .metric-item strong{
    display: block;
    font-size: 1.2rem;
    margin-bottom: 6px;
    color: #0366d6;
  }
  .metric-desc {
    font-size: 0.9rem;
    color: #586069;
  }

  /* Weather alerts */
  .alerts-container {
    margin: 0 auto 32px auto;
    max-width: 780px;
  }
  .alert {
    border-left: 6px solid;
    background: #f6f8fa;
    padding: 12px 20px;
    border-radius: 6px;
    margin-bottom: 12px;
    box-shadow: 0 2px 8px rgba(36,41,46,0.05);
    color: #24292e;
  }
  .alert.severity-low {
    border-color: #28a745;
    background: #ebfbee;
  }
  .alert.severity-moderate {
    border-color: #f66a0a;
    background: #fff7e6;
  }
  .alert.severity-high {
    border-color: #d73a49;
    background: #ffe5e6;
  }
  .alert-title {
    font-weight: 700;
    margin-bottom: 4px;
  }
  .alert-time {
    font-size: 0.8rem;
    color: #586069;
  }

  /* Responsive */
  @media (max-width: 768px) {
    header {
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
    }
    .location-selector {
      flex-basis: 100%;
      order: 2;
    }
    .search-container {
      order: 3;
      flex-basis: 100%;
      justify-content: center;
    }
    .current-weather {
      flex-direction: column;
      gap: 12px;
    }
    .current-temp {
      font-size: 4.5rem;
      min-width: auto;
    }
    .hourly-card {
      flex: 0 0 56px;
      font-size: 0.75rem;
      padding: 10px 6px;
    }
    .daily-forecast {
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 16px;
    }
    .metric-card, .metric-item {
      padding: 14px 12px;
    }
  }

</style>
</head>
<body data-condition="sunny">

<header role="banner" aria-label="Application header">
  <h1>Weather Dashboard</h1>
  <div class="location-selector">
    <select class="location-select" aria-label="Select a location" id="locationSelect" name="locations" >
      <option value="1">San Francisco, USA</option>
      <option value="2">London, UK</option>
      <option value="3">Tokyo, Japan</option>
      <option value="4">Sydney, Australia</option>
    </select>
    <span class="material-icons" aria-hidden="true">arrow_drop_down</span>
  </div>
  <div class="search-container" role="search">
    <input type="search" id="searchInput" aria-label="Search location" class="search-input" placeholder="Search location..." />
    <button title="Use GPS location" aria-label="Use GPS to get current location" class="icon-button" id="gpsButton" tabindex="0">
      <span class="material-icons">my_location</span>
    </button>
  </div>
  <button title="Settings" aria-label="Open settings" class="icon-button" id="settingsButton">
    <span class="material-icons">settings</span>
  </button>
</header>

<main class="container" role="main" aria-live="polite">
  <!-- Current Weather -->
  <section class="card current-weather" aria-label="Current weather conditions" id="currentWeather">
    <div>
      <div class="current-temp" id="currentTemp" aria-live="polite">--°C</div>
    </div>
    <div class="current-condition">
      <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1885fa08-b611-4df1-baa2-113d3a4731a4.png" alt="Animated icon of sunny weather" class="weather-icon" id="currentIcon" />
      <div id="currentConditionText">--</div>
      <div id="feelsLikeText">Feels like --°C</div>
      <div id="humidityText">Humidity: --%</div>
      <div id="pressureText">Pressure: -- hPa</div>
      <div id="windText">Wind: -- km/h</div>
      <div id="uvText">UV Index: --</div>
      <div id="visibilityText" style="font-size:0.85rem; margin-top:12px; color:#666;">Visibility: -- km</div>
    </div>
  </section>

  <!-- Hourly forecast -->
  <section aria-label="24-hour hourly weather forecast" class="hourly-forecast">
    <div class="hourly-list" id="hourlyList" tabindex="0" aria-live="polite" aria-relevant="additions">
      <!-- Hourly cards inserted dynamically -->
    </div>
  </section>

  <!-- 7-day forecast -->
  <section aria-label="7-day weather forecast" class="daily-forecast" id="dailyForecast">
    <!-- Daily cards inserted dynamically -->
  </section>

  <!-- Metrics row: Air Quality & UV Index -->
  <section class="metrics-row" aria-label="Air quality and UV index metrics">
    <div class="metric-card" id="airQualityCard" aria-live="polite">
      <div class="metric-title">Air Quality Index</div>
      <div class="circular-progress" aria-label="Air Quality Index">
        <svg viewBox="0 0 120 120" aria-hidden="true" focusable="false">
          <circle cx="60" cy="60" r="50" class="progress-bg" />
          <circle cx="60" cy="60" r="50" class="progress-fg" id="airQualityCircle" stroke-dasharray="314" stroke-dashoffset="314" />
        </svg>
        <div class="progress-value" id="airQualityValue">--</div>
      </div>
      <div id="airQualityRecommendation" style="font-size:0.85rem; color:#444;">Loading...</div>
    </div>

    <div class="metric-card" id="uvIndexCard" aria-live="polite">
      <div class="metric-title">UV Index</div>
      <div class="circular-progress" aria-label="UV Index">
        <svg viewBox="0 0 120 120" aria-hidden="true" focusable="false">
          <circle cx="60" cy="60" r="50" class="progress-bg" />
          <circle cx="60" cy="60" r="50" class="progress-fg" id="uvIndexCircle" stroke-dasharray="314" stroke-dashoffset="314" />
        </svg>
        <div class="progress-value" id="uvIndexValue">--</div>
      </div>
      <div id="uvIndexRecommendation" style="font-size:0.85rem; color:#444;">Loading...</div>
    </div>
  </section>

  <!-- Weather Map with tabs -->
  <section class="map-section" aria-label="Weather maps and radar">
    <div class="map-tabs" role="tablist" aria-orientation="horizontal">
      <button class="map-tab-button active" role="tab" aria-selected="true" aria-controls="mapRadar" id="tabRadar">Radar</button>
      <button class="map-tab-button" role="tab" aria-selected="false" aria-controls="mapSatellite" id="tabSatellite">Satellite</button>
      <button class="map-tab-button" role="tab" aria-selected="false" aria-controls="mapTemp" id="tabTemp">Temperature</button>
    </div>
    <div id="mapRadar" class="map-placeholder" role="tabpanel" aria-labelledby="tabRadar"></div>
    <div id="mapSatellite" class="map-placeholder" role="tabpanel" aria-labelledby="tabSatellite" hidden></div>
    <div id="mapTemp" class="map-placeholder" role="tabpanel" aria-labelledby="tabTemp" hidden></div>
  </section>

  <!-- Weather Alerts -->
  <section class="alerts-container" aria-label="Weather alerts" id="alertsContainer">
    <!-- Alerts dynamically inserted -->
  </section>

  <!-- Bottom additional metrics & insights -->
  <section class="bottom-metrics" aria-label="Additional weather metrics and insights">
    <div class="metric-item" id="sunriseMetric">
      <strong>Sunrise</strong>
      <span id="sunriseTime">--:--</span>
    </div>
    <div class="metric-item" id="sunsetMetric">
      <strong>Sunset</strong>
      <span id="sunsetTime">--:--</span>
    </div>
    <div class="metric-item" id="windDirectionMetric">
      <strong>Wind Direction</strong>
      <span id="windDirectionValue">--</span>
      <div style="width:48px; height:48px; margin: 8px auto;" aria-hidden="true">
        <svg viewBox="0 0 64 64" width="48" height="48" >
          <circle cx="32" cy="32" r="30" stroke="#0366d6" stroke-width="2" fill="none"/>
          <polygon points="32,8 28,26 32,22 36,26" fill="#0366d6" transform="rotate(0, 32, 32)" id="windDirectionArrow"/>
        </svg>
      </div>
    </div>
    <div class="metric-item" id="humidityMetric">
      <strong>Humidity</strong>
      <span id="humidityValue">--%</span>
    </div>
    <div class="metric-item" id="pressureMetric">
      <strong>Pressure</strong>
      <span id="pressureValue">-- hPa</span>
    </div>
    <div class="metric-item" id="visibilityMetric">
      <strong>Visibility</strong>
      <span id="visibilityValue">-- km</span>
    </div>
  </section>
</main>

<script>
  (() => {
    // Simulated data structures
    const locations = [
      { id: "1", name: "San Francisco", country: "USA", coordinates: [37.7749, -122.4194], timezone: "America/Los_Angeles", isDefault: true, isFavorite: true },
      { id: "2", name: "London", country: "UK", coordinates: [51.5074, -0.1278], timezone: "Europe/London", isDefault: false, isFavorite: false },
      { id: "3", name: "Tokyo", country: "Japan", coordinates: [35.6762, 139.6503], timezone: "Asia/Tokyo", isDefault: false, isFavorite: false },
      { id: "4", name: "Sydney", country: "Australia", coordinates: [-33.8688, 151.2093], timezone: "Australia/Sydney", isDefault: false, isFavorite: false }
    ];

    // Utility for formatting time in HH:mm based on timezone offset (simulated)
    function formatTime(dateStr, offsetMinutes = 0) {
      const date = new Date(dateStr);
      date.setMinutes(date.getMinutes() + offsetMinutes);
      const hh = date.getHours().toString().padStart(2, "0");
      const mm = date.getMinutes().toString().padStart(2, "0");
      return `${hh}:${mm}`;
    }

    // Update background gradient based on condition
    function updateWeatherBackground(condition) {
      const validConditions = ['sunny','cloudy','rainy','snowy','stormy'];
      if (validConditions.includes(condition)) {
        document.body.dataset.condition = condition;
      } else {
        document.body.dataset.condition = 'sunny';
      }
    }

    // Generate random realistic forecasts
    function generateRealisticForecast(days, coordinates) {
      const conditions = ['sunny','cloudy','rainy','snowy','stormy'];
      let today = new Date();
      let forecast = [];
      for(let i = 0; i < days; i++) {
        let date = new Date(today);
        date.setDate(today.getDate() + i);
        let condition = conditions[Math.floor(Math.random()* conditions.length)];
        let high = Math.round(Math.random()*15 + 15);
        let low = Math.round(high - Math.random()*10);
        let precipitation = Math.random() > 0.7 ? Math.round(Math.random()*20) : 0;
        let windSpeed = Math.round(Math.random()*25 + 5);
        let hourly = [];
        for(let h=0; h<24; h++) {
          hourly.push({
            time: `${h}:00`,
            temp: Math.round(low + (high-low)*Math.random()),
            condition: conditions[Math.floor(Math.random()* conditions.length)]
          });
        }
        forecast.push({date: date.toISOString(), high, low, condition, precipitation, wind: windSpeed, hourly});
      }
      return forecast;
    }

    // Simulate air quality index data and recommendations
    function simulateAirQuality() {
      const aqi = Math.floor(Math.random() * 200);
      let recommendation = '';
      if(aqi <= 50) recommendation = 'Good air quality. No health implications.';
      else if(aqi <= 100) recommendation = 'Moderate air quality. Sensitive individuals should reduce outdoor activities.';
      else if(aqi <= 150) recommendation = 'Unhealthy for sensitive groups. Limit prolonged outdoor exertion.';
      else recommendation = 'Unhealthy. Avoid outdoor activities.';
      return { aqi, recommendation };
    }

    // UV index and recommendations
    function simulateUVIndex() {
      const uv = Math.floor(Math.random() * 12);
      let rec = '';
      if(uv <= 2) rec = 'Low risk. No protection needed.';
      else if(uv <= 5) rec = 'Moderate risk. Wear sunglasses and seek shade.';
      else if(uv <= 7) rec = 'High risk. Apply SPF 30+ sunscreen.';
      else rec = 'Very high risk. Avoid sun exposure during midday.';
      return { uv, rec };
    }

    // Wind direction degrees to compass
    function degreesToCompass(num) {
      const val = Math.floor((num / 22.5) + 0.5);
      const arr = ["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];
      return arr[(val % 16)];
    }

    // Update the current weather display
    function updateCurrentWeather(current) {
      document.getElementById('currentTemp').textContent = current.temperature + '°C';
      document.getElementById('currentConditionText').textContent = capitalize(current.condition);
      document.getElementById('feelsLikeText').textContent = 'Feels like ' + current.feelsLike + '°C';
      document.getElementById('humidityText').textContent = 'Humidity: ' + current.humidity + '%';
      document.getElementById('pressureText').textContent = 'Pressure: ' + current.pressure + ' hPa';
      document.getElementById('windText').textContent = 'Wind: ' + current.windSpeed + ' km/h';
      document.getElementById('uvText').textContent = 'UV Index: ' + current.uvIndex;
      document.getElementById('visibilityText').textContent = 'Visibility: ' + current.visibility + ' km';

      // Update wind direction compass
      const windDir = degreesToCompass(current.windDirection);
      document.getElementById('windDirectionValue').textContent = windDir;
      const arrow = document.getElementById('windDirectionArrow');
      arrow.setAttribute('transform', `rotate(${current.windDirection}, 32, 32)`);

      // Update humidity, pressure, visibility bottom metrics duplicates
      document.getElementById('humidityValue').textContent = current.humidity + '%';
      document.getElementById('pressureValue').textContent = current.pressure + ' hPa';
      document.getElementById('visibilityValue').textContent = current.visibility + ' km';

      // Update current weather icon with appropriate placeholder
      const iconImg = document.getElementById('currentIcon');
      const conditionToImageText = {
        sunny: 'Sunny',
        cloudy: 'Cloudy',
        rainy: 'Rainy',
        snowy: 'Snowy',
        stormy: 'Stormy'
      };
      iconImg.src = `https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/9616991d-bb7c-4644-a980-09a92712a84d.png || 'Weather'}`;
      iconImg.alt = `Animated icon of ${current.condition} weather`;
    }

    // Update hourly forecast UI
    function updateHourlyForecast(hourly) {
      const container = document.getElementById('hourlyList');
      container.innerHTML = '';
      hourly.forEach(hour => {
        const card = document.createElement('div');
        card.className = 'hourly-card';
        const time = document.createElement('div');
        time.className = 'hourly-time';
        time.textContent = hour.time;
        const icon = document.createElement('img');
        icon.className = 'hourly-icon';
        icon.alt = `Icon for ${hour.condition} weather`;
        icon.src = `https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/023b37c2-2796-4174-b629-3f7015278811.png)}`;
        const temp = document.createElement('div');
        temp.className = 'hourly-temp';
        temp.textContent = hour.temp + '°C';

        card.appendChild(time);
        card.appendChild(icon);
        card.appendChild(temp);
        container.appendChild(card);
      });
    }

    // Update 7-day forecast UI
    function updateDailyForecast(daily) {
      const container = document.getElementById('dailyForecast');
      container.innerHTML = '';
      daily.forEach(day => {
        const card = document.createElement('div');
        card.className = 'daily-card';

        const date = new Date(day.date);
        const options = { weekday: 'short' };
        const dayName = date.toLocaleDateString(undefined, options);

        const dayLabel = document.createElement('div');
        dayLabel.className = 'daily-day';
        dayLabel.textContent = dayName;

        const icon = document.createElement('img');
        icon.className = 'daily-icon';
        icon.alt = `Icon for ${day.condition} weather`;
        icon.src = `https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5c550da4-bd7c-42a0-a97f-aca61ac8a39d.png)}`;

        const temps = document.createElement('div');
        temps.className = 'daily-temp';
        const high = document.createElement('span');
        high.className = 'temp-high';
        high.textContent = day.high + '°';
        const low = document.createElement('span');
        low.className = 'temp-low';
        low.textContent = day.low + '°';

        temps.appendChild(high);
        temps.appendChild(low);

        card.appendChild(dayLabel);
        card.appendChild(icon);
        card.appendChild(temps);
        container.appendChild(card);
      });
    }

    // Update circular progress indicators for air quality, UV index
    function updateCircularProgress(circleElem, value, max=200) {
      const radius = 50;
      const circumference = 2 * Math.PI * radius;
      const percent = Math.min(value, max)/max;
      const offset = circumference * (1 - percent);
      circleElem.style.strokeDashoffset = offset;
    }

    // Update AQI and UV metrics
    function updateMetrics(airQuality, uvIndex) {
      const airQCircle = document.getElementById('airQualityCircle');
      const airQVal = document.getElementById('airQualityValue');
      const airQRec = document.getElementById('airQualityRecommendation');

      updateCircularProgress(airQCircle, airQuality.aqi, 200);
      airQVal.textContent = airQuality.aqi;
      airQRec.textContent = airQuality.recommendation;

      const uvCircle = document.getElementById('uvIndexCircle');
      const uvVal = document.getElementById('uvIndexValue');
      const uvRec = document.getElementById('uvIndexRecommendation');

      updateCircularProgress(uvCircle, uvIndex.uv, 11);
      uvVal.textContent = uvIndex.uv;
      uvRec.textContent = uvIndex.rec;
    }

    // Update sunrise and sunset times
    function updateAstronomy(astronomy) {
      document.getElementById('sunriseTime').textContent = astronomy.sunrise;
      document.getElementById('sunsetTime').textContent = astronomy.sunset;
    }

    // Display weather alerts
    function updateAlerts(alerts) {
      const container = document.getElementById('alertsContainer');
      container.innerHTML = '';
      if(alerts.length === 0){
        const noAlert = document.createElement('p');
        noAlert.textContent = 'No weather alerts.';
        noAlert.style.color = '#586069';
        container.appendChild(noAlert);
        return;
      }
      alerts.forEach(alert => {
        const alertDiv = document.createElement('div');
        alertDiv.className = 'alert severity-' + alert.severity.toLowerCase();
        alertDiv.setAttribute('role','alert');
        alertDiv.innerHTML = `
          <div class="alert-title">${alert.title}</div>
          <div>${alert.description}</div>
          <div class="alert-time">From ${new Date(alert.startTime).toLocaleString()} to ${new Date(alert.endTime).toLocaleString()}</div>
        `;
        container.appendChild(alertDiv);
      });
    }

    // Capitalize helper
    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    // Simulated updateWeatherData function
    function updateWeatherData(locationId) {
      const location = locations.find(l => l.id === locationId);
      if (!location) return;

      // Conditions
      const conditions = ['sunny', 'cloudy', 'rainy', 'snowy', 'stormy'];
      const chosenCondition = conditions[Math.floor(Math.random() * conditions.length)];

      // Generate current weather
      const current = {
        temperature: Math.round(Math.random() * 35 + 5),
        feelsLike: Math.round(Math.random() * 35 + 5),
        condition: chosenCondition,
        humidity: Math.round(Math.random() * 60 + 20),
        pressure: Math.round(Math.random() * 50 + 980),
        windSpeed: Math.round(Math.random() * 25 + 5),
        windDirection: Math.floor(Math.random() * 360),
        uvIndex: Math.round(Math.random() * 11),
        visibility: Math.round(Math.random() * 10 + 5),
        timestamp: new Date().toISOString()
      };

      // Generate 7-day forecast
      const forecast = generateRealisticForecast(7, location.coordinates);

      // Simulate alerts - randomly add 1 alert sometimes
      const alerts = (Math.random() < 0.3) ? [{
        id: 'alert1',
        type: 'Storm Warning',
        severity: ['Low', 'Moderate', 'High'][Math.floor(Math.random() * 3)],
        title: 'Severe Storm Approaching',
        description: 'Heavy winds and rain expected, take necessary precautions.',
        startTime: new Date().toISOString(),
        endTime: new Date(Date.now() + 3 * 3600000).toISOString(),
        areas: [location.name]
      }] : [];

      // Air Quality
      const airQuality = simulateAirQuality();

      // UV index recommendations
      const uvIndex = simulateUVIndex();

      // Astronomy (sunrise, sunset, etc.) simulate simple fixed times for demo
      const astronomy = {
        sunrise: '06:45',
        sunset: '19:10',
        moonPhase: 'Waxing Crescent',
        goldenHour: true,
      };

      // Update UI
      updateCurrentWeather(current);
      updateHourlyForecast(forecast[0].hourly);
      updateDailyForecast(forecast);
      updateMetrics(airQuality, uvIndex);
      updateAstronomy(astronomy);
      updateAlerts(alerts);
      updateWeatherBackground(current.condition);
    }

    // Map tab switching
    function initMapTabs(){
      const tabs = document.querySelectorAll('.map-tab-button');
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const parent = tab.parentElement;
          const allTabs = parent.querySelectorAll('.map-tab-button');
          allTabs.forEach(t => {
            t.classList.remove('active');
            t.setAttribute('aria-selected', 'false');
          });
          tab.classList.add('active');
          tab.setAttribute('aria-selected', 'true');
          const panelId = tab.getAttribute('aria-controls');
          const parentSection = parent.parentElement;
          parentSection.querySelectorAll('.map-placeholder').forEach(panel => {
            panel.hidden = (panel.id !== panelId);
          });
        });
      });
    }

    // Search input handler (simple filtering select options)
    function initSearchFilter(){
      const searchInput = document.getElementById('searchInput');
      const selectElem = document.getElementById('locationSelect');
      searchInput.addEventListener('input', () => {
        const val = searchInput.value.toLowerCase();
        for (const option of selectElem.options) {
          option.hidden = !option.text.toLowerCase().includes(val);
        }
      });
    }

    // On location change update weather
    function initLocationChange() {
      const selectElem = document.getElementById('locationSelect');
      selectElem.addEventListener('change', () => {
        updateWeatherData(selectElem.value);
      });
    }

    // GPS simulation button
    function initGPSButton() {
      const button = document.getElementById('gpsButton');
      button.addEventListener('click', () => {
        alert('GPS simulation: Using location San Francisco');
        document.getElementById('locationSelect').value = "1";
        updateWeatherData("1");
      });
    }

    // Initialize all
    function init() {
      initMapTabs();
      initSearchFilter();
      initLocationChange();
      initGPSButton();
      // Initialize with default location
      const defaultLocation = locations.find(l => l.isDefault) || locations[0];
      document.getElementById('locationSelect').value = defaultLocation.id;
      updateWeatherData(defaultLocation.id);
    }

    // Run on load
    window.addEventListener('DOMContentLoaded', init);
  })();
</script>

</body>
</html>

